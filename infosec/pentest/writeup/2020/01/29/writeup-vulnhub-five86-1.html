<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <META HTTP-EQUIV='Content-Security-Policy' CONTENT="default-src 'self' ; script-src 'self' 'unsafe-inline' www.google-analytics.com; style-src 'self' 'unsafe-inline' a.disquscdn.com; img-src 'self' *; media-src 'self' ; frame-src disqus.com;"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Writeup - Vulnhub machine - Five86-1 | bt0’s Security Blog</title>
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="Writeup - Vulnhub machine - Five86-1" />
<meta name="author" content="Humberto Jr (bt0)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Hi guys," />
<meta property="og:description" content="Hi guys," />
<link rel="canonical" href="https://humbertojunior.com.br/infosec/pentest/writeup/2020/01/29/writeup-vulnhub-five86-1.html" />
<meta property="og:url" content="https://humbertojunior.com.br/infosec/pentest/writeup/2020/01/29/writeup-vulnhub-five86-1.html" />
<meta property="og:site_name" content="bt0’s Security Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-01-29T00:00:00-03:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Writeup - Vulnhub machine - Five86-1" />
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"Writeup - Vulnhub machine - Five86-1","dateModified":"2020-01-29T00:00:00-03:00","datePublished":"2020-01-29T00:00:00-03:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://humbertojunior.com.br/infosec/pentest/writeup/2020/01/29/writeup-vulnhub-five86-1.html"},"url":"https://humbertojunior.com.br/infosec/pentest/writeup/2020/01/29/writeup-vulnhub-five86-1.html","author":{"@type":"Person","name":"Humberto Jr (bt0)"},"description":"Hi guys,","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://humbertojunior.com.br/feed.xml" title="bt0's Security Blog" /><script async src="https://www.googletagmanager.com/gtag/js?id=G-RQVR6R8WR3"></script>
<script>
  window['ga-disable-G-RQVR6R8WR3'] = window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1";
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-RQVR6R8WR3');
</script>
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5149953309426611"
     crossorigin="anonymous"></script></head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">bt0&#39;s Security Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about.html">About · bt0</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Writeup - Vulnhub machine - Five86-1</h1>
    <p class="post-meta"><time class="dt-published" datetime="2020-01-29T00:00:00-03:00" itemprop="datePublished">
        Jan 29, 2020
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Hi guys,</p>

<p>Today i am posting my first try to write a walkthrough of a OSCP like
machine that i’ve download in vulnhub project. i’ve chosen that machine
because it’s intended to be a beginner’s challenge and it helps a lot to
understand how Capture the Flag competitions are made.</p>

<h2 id="vulnhub">Vulnhub</h2>

<p><strong>Aim/Goal</strong></p>

<p>To provide materials that allow anyone to gain practical ‘hands-on’
experience in digital security, computer software &amp; network
administration.</p>

<p><a href="https://www.vulnhub.com/">Vunlnhub Site</a></p>

<h2 id="about-our-target-machine">About our target machine</h2>

<p><strong>Description</strong></p>

<p>Five86-1 is another purposely built vulnerable lab with the intent of
gaining experience in the world of penetration testing.</p>

<p>The ultimate goal of this challenge is to get root and to read the one
and only flag.</p>

<p>Linux skills and familiarity with the Linux command line are a must, as
is some experience with basic penetration testing tools.</p>

<p>For beginners, Google can be of great assistance, but you can always
tweet me at @DCAU7 for assistance to get you going again. But take note:
I won’t give you the answer, instead, I’ll give you an idea about how to
move forward. Technical Information</p>

<p>Five86-1 is a VirtualBox VM built on Debian 64 bit, but there shouldn’t
be any issues running it on most PCs.</p>

<p>Five86-1 has been tested successfully on VMWare Player, but if there are
any issues running this VM in VMware, have a read through of this.</p>

<p>It is currently configured for Bridged Networking, however, this can be
changed to suit your requirements. Networking is configured for DHCP.</p>

<p>Installation is simple - download it, unzip it, and then import it into
VirtualBox or VMWare and away you go.</p>

<p><strong>Important</strong></p>

<p>While there should be no problems using this VM, by downloading it, you
accept full responsibility for any unintentional damage that this VM may
cause.</p>

<p>In saying that, there shouldn’t be any problems, but I feel the need to
throw this out there just in case.</p>

<p><strong>Credits</strong></p>

<p>A big thanks goes out to the members of @m0tl3ycr3w.</p>

<p><strong>Contact</strong></p>

<p>I’m also very interested in hearing how people go about solving these
challenges, so if you’re up for writing a walkthrough, please do so and
send me a link, or alternatively, follow me on Twitter, and DM me (you
can unfollow after you’ve DM’d me if you’d prefer).</p>

<p>I can be contacted via Twitter - @Five86_x</p>

<p><a href="https://www.vulnhub.com/entry/five86-1,417/">Download Five86-1 VM</a></p>

<h2 id="tools-and-blogs">Tools and Blogs</h2>

<p>I am using Kali Linux 2019.4 and the new Kali Undercover theme (just to
be fashionable lol!)</p>

<p><img src="https://www.kali.org/wp-content/uploads/2019/11/kali-undercover-1.gif" alt="KaliUndercover" /></p>

<ul>
  <li>Netdiscover</li>
  <li>Nmap</li>
  <li>Nikto</li>
  <li>Crunch</li>
  <li>Hashcat</li>
  <li>Metasploit</li>
  <li>GTFO Bins</li>
  <li>Rebootuser Blog</li>
  <li>Virtualbox (for labs)</li>
</ul>

<p>Post Exploitation List
https://github.com/mubix/post-exploitation/wiki/Linux-Post-Exploitation-Command-List</p>

<h2 id="recon">Recon</h2>

<p>After download and import the VM (i am using Virtualbox), everything
configured to run inside the virtualbox private network.</p>

<p><img src="/assets/img/writeupfive86-1/00a-virtualbox-network.png" alt="VirtualboxNetwork" /></p>

<p>The network configured in Host-only Adapter is 192.168.56.0/24 and the
DHCP is enabled.</p>

<p>First step is to discover which IP address our target VM got after boot.
We will do that using the netdiscover tool.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ netdiscover -i eth1 -r 192.168.56.0/24

-i = interface (using eth1 because my kali linux has two interfaces and eth1 is the Host-only adapter)
-r = range
</code></pre></div></div>

<p><img src="/assets/img/writeupfive86-1/00-netdiscover.png" alt="Netdiscover" /></p>

<p>We can realize that target VM is 192.168.56.15 since the two other IPs
are our hypervisor default addresses. Our Kali Linux machine got
192.168.56.9</p>

<p>The next step is to try to discover which services are running on our
target. We can do this type of scan using nmap.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ nmap -sC -sV -sT 192.168.56.15
</code></pre></div></div>

<p><img src="/assets/img/writeupfive86-1/01-nmap-recon.png" alt="NmapRecon" /></p>

<p>At this point we have information about a SSH server in port 22, a
webserver in port 80 with robots.txt and a disallowed entry to /ona
directory (interesting!) and port 10000 running a Webmin version 1.9.20
service.</p>

<p>We can try to pull more details running nikto in port 80.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ nikto -host 192.168.56.15
</code></pre></div></div>

<p><img src="/assets/img/writeupfive86-1/02-nikto-recon.png" alt="Nikto" /></p>

<p>As we can see, nothing new about our target after nikto results.</p>

<p>Let’s try to search for some more information about our services
versions that we got using google and exploit-db.</p>

<p><img src="/assets/img/writeupfive86-1/03-exploit-db.png" alt="Exploit-db" /></p>

<p>The first search points to a Webmin vulnerability in version 1.9.20 that
brings to an unauthenticated RCE. The exploit is also a Metasploit
module that does things easier to exploit. The only exception is:</p>

<p><em>This module exploits a backdoor in Webmin versions 1.890 through 1.920.
Only the SourceForge downloads were backdoored, but they are listed as
official downloads on the project’s site.</em></p>

<p><img src="/assets/img/writeupfive86-1/04-webmin-login.png" alt="WebminLogin" /></p>

<p>So, the exploit author says the module only works on versions downloaded
from sourceforge. It should be a problem if our version were downloaded
from apt source or another official not backdoored source. Actually,
i’ve tested after finding this information and exploit didn’t work,
confirming probably the version is not backdoored.</p>

<p>Let’s move on!</p>

<p>As we’ve saw before we have a robots.txt with some restrictions in its
configuration. The robots config prevents /ona directory being
discovered. Browsing to the /ona path we can see a web application
running.</p>

<p><img src="/assets/img/writeupfive86-1/05-ona-page.png" alt="OnaDir" /></p>

<p>The Ona 18.1.1 is running and have known vulnerabilities and also
working exploits.</p>

<p><img src="/assets/img/writeupfive86-1/05a-ona-exploitdb.png" alt="OnaExploit" /></p>

<p>Yes! Exploit-db shows a metasploit module for this vulnerabilty. Let’s
try to search it in MSF.</p>

<p><img src="/assets/img/writeupfive86-1/05b-ona-exploit.png" alt="OnaExploit" /></p>

<p>At this part, i had a problem to solve that was Metasploit haven’t the
Ona exploit module already installed and i had to install manually.
That’s why i searched using searchsploit tool before. To install a non
existent module in MSF you have to copy the .rb file to its directory
(/usr/share/metasploit-framework/modules/exploits/) and update its
database (updatedb). After updating you have to restart metasploit to
have the exploit appearing in searches.</p>

<p>I’ve chosen the directory and file names like that
(/usr/share/metasploit-framework/modules/exploits/linux/http/opennetadmin.rb).
You can chose yours as you wish but it`s a good practice put it inside
its location. You can see that detail just opening the .rb file and
reading the description of module.</p>

<h2 id="exploitation">Exploitation</h2>

<p>Now it’s time to exploit the first phase of writeup.</p>

<p><img src="/assets/img/writeupfive86-1/05c-ona-metasploit.png" alt="OnaExploit" /></p>

<p>Session created. Now we have access to the VM Shell through MSF.</p>

<p><img src="/assets/img/writeupfive86-1/06a-www-id.png" alt="www-user" /></p>

<p>As usual, we start the phase of privilege escalation with enumeration.
In the very beginning, i’ve tried a lot of enumeration like sudo
permission, file permission, mails, hidden directories and other initial
scans like linenum and post exploitation modules in metasploit. The only
one thing i forgot to try was the first directory that popped when i’ve
exploited the ona vulnerability. Because of that, i’ve lost some time
trying other methods. It helps to be an advice: Always enumerate every
single place that you have access. The answer is the next screenshot:</p>

<p><img src="/assets/img/writeupfive86-1/06-www-directory.png" alt="www-user" /></p>

<p>We can see the username and its hash in the .htpasswd file. The author
also sent a tip to not use regular wordlists but create a new one using
10 chars and the letters <strong>aefhrt</strong>. For this part i’ve used the Crunch
tool to create our dictionary and after that we start the decryption
tool hashcat to crack its password.</p>

<p><img src="/assets/img/writeupfive86-1/07-dictionary.png" alt="crunch" /></p>

<p><img src="/assets/img/writeupfive86-1/08a-hashcat-cracking-hash.png" alt="hashcat" /></p>

<p><img src="/assets/img/writeupfive86-1/08-hashcat-cracking-hash.png" alt="hashcat" /></p>

<p>Having the douglas password now we can try to access his shell using ssh
or even su in the www shell.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ssh douglas@192.168.56.15 (password fatherrrrr)
or
$ su douglas
</code></pre></div></div>

<p><img src="/assets/img/writeupfive86-1/09-ssh-douglas-password.png" alt="douglas" /></p>

<p>Enumerating douglas account we can see an interesting result when i’ve
tried sudo -l. It shows that user jen has access to run the command cp
without any password. Thinking malicious, if you have access to copy any
file using another account you should for example put some files inside
their home directory. So, why not to try copying a generated by me ssh
key to his .ssh directory and ssh there ? Let’s try.</p>

<p><img src="/assets/img/writeupfive86-1/10-enumerate-douglas.png" alt="douglas" /></p>

<ul>
  <li>Generating the ssh key to exploit Jen’s ssh access</li>
</ul>

<p><img src="/assets/img/writeupfive86-1/11-creating-jen-sshkey.png" alt="douglas" /></p>

<ul>
  <li>Next steps are: chmod 777 the id_rsa.pub file and copy to .ssh
directory inside Jen’s home directory as authorized_keys file.
After that just try to ssh using jen’s “new” key.</li>
</ul>

<p><img src="/assets/img/writeupfive86-1/12-accessing-jen-ssh.png" alt="douglas" /></p>

<p>Since we have access to Jen’s account it’s time, as usual, to enumerate
the user.</p>

<p><img src="/assets/img/writeupfive86-1/13-enumerating-jen.png" alt="jens-account" /></p>

<p>Two interesting things about exim4 application and Jen has an unread
mail in his box. About exim4, it’s good to mention that exim on this
version has some known vulnerability and i’ve tried to exploit it but
had no success (rabbit hole). Another known vulnerabilty is shown about
its kernel (Linux five86-1 4.19.0-6-amd64 #1 SMP Debian
4.19.67-2+deb10u2 (2019-11-11) x86_64 GNU/Linux) and i also tried to
exploit using known exploits but no success too.</p>

<p>So, having failures exploiting exim and kernel, let’s try to see the
jen’s mailbox.</p>

<p><img src="/assets/img/writeupfive86-1/14-mail-jen.png" alt="jens-account" /></p>

<p>Gotcha! Jen’s mailbox message has the information of another user
(moss). Let’s try to access moss account using its password (Fire!Fire!)</p>

<p><img src="/assets/img/writeupfive86-1/15-ssh-moss.png" alt="moss-account" /></p>

<p>The final step is to enumerate moss account as usual. After looking for
files with permission we’ve found a file that could be executed by moss.
Looks like a game. Lets execute it.</p>

<p><img src="/assets/img/writeupfive86-1/16-moss-flag.png" alt="moss-account" /></p>

<p>Running the game i’ve answered the questions and it popped the root
shell.</p>

<p><strong>That’s all folks!</strong></p>

<p>Thanks for reading</p>

  </div><a class="u-url" href="/infosec/pentest/writeup/2020/01/29/writeup-vulnhub-five86-1.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">Humberto Jr (bt0)</li>
          <li><a class="u-email" href="mailto:bt0@tutanota.com">bt0@tutanota.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>Just another Infosec Blog - Resources, Tutorial</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/halencarjunior" title="halencarjunior"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/bt0s3c" title="bt0s3c"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>
    <script src="https://code.jquery.com/jquery-2.1.4.min.js"
  integrity="sha384-R4/ztc4ZlRqWjqIuvf6RX5yb/v90qNGx6fS48N0tRxiGkqveZETq72KgDVJCp2TC"
  crossorigin="anonymous"></script>
  </div>

</footer>
</body>

</html>
