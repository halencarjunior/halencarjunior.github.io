<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>How to brute force SSH - Some Tools | bt0’s Security Blog</title>
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="How to brute force SSH - Some Tools" />
<meta name="author" content="Humberto Jr (bt0)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Hello guys, in this topic I’ll show you some tools and its commands to start a brute force in SSH servers." />
<meta property="og:description" content="Hello guys, in this topic I’ll show you some tools and its commands to start a brute force in SSH servers." />
<link rel="canonical" href="https://humbertojunior.com.br/infosec/pentest/2020/01/17/ssh-bruteforce-some-tools.html" />
<meta property="og:url" content="https://humbertojunior.com.br/infosec/pentest/2020/01/17/ssh-bruteforce-some-tools.html" />
<meta property="og:site_name" content="bt0’s Security Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-01-17T00:00:00-03:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="How to brute force SSH - Some Tools" />
<script type="application/ld+json">
{"@type":"BlogPosting","url":"https://humbertojunior.com.br/infosec/pentest/2020/01/17/ssh-bruteforce-some-tools.html","headline":"How to brute force SSH - Some Tools","dateModified":"2020-01-17T00:00:00-03:00","datePublished":"2020-01-17T00:00:00-03:00","author":{"@type":"Person","name":"Humberto Jr (bt0)"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://humbertojunior.com.br/infosec/pentest/2020/01/17/ssh-bruteforce-some-tools.html"},"description":"Hello guys, in this topic I’ll show you some tools and its commands to start a brute force in SSH servers.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://humbertojunior.com.br/feed.xml" title="bt0's Security Blog" /><script async src="https://www.googletagmanager.com/gtag/js?id=G-RQVR6R8WR3"></script>
<script>
  window['ga-disable-G-RQVR6R8WR3'] = window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1";
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-RQVR6R8WR3');
</script>
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5149953309426611"
     crossorigin="anonymous"></script></head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">bt0&#39;s Security Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about.html">About · bt0</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">How to brute force SSH - Some Tools</h1>
    <p class="post-meta"><time class="dt-published" datetime="2020-01-17T00:00:00-03:00" itemprop="datePublished">
        Jan 17, 2020
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5149953309426611" crossorigin="anonymous"></script>
        <ins class="adsbygoogle"
        style="display:block; text-align:center;"
        data-ad-layout="in-article"
        data-ad-format="fluid"
        data-ad-client="ca-pub-5149953309426611"
        data-ad-slot="3196203233"></ins>
    <script>
       (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
    <p>Hello guys, in this topic I’ll show you some tools and its commands to
start a brute force in SSH servers.</p>

<p>Disclaimer: First of all, it’s good to say that you should not run this
kind of tool on servers that you don’t have permission to scan. The
risks of doing something like that is at your own.</p>

<h2 id="brute-force-attack">Brute Force Attack</h2>

<p>From <a href="https://en.wikipedia.org/wiki/Brute-force_attack">Wikipedia</a>:</p>

<p><em>In cryptography, a brute-force attack consists of an attacker
submitting many passwords or passphrases with the hope of eventually
guessing correctly. The attacker systematically checks all possible
passwords and passphrases until the correct one is found. Alternatively,
the attacker can attempt to guess the key which is typically created
from the password using a key derivation function. This is known as an
exhaustive key search.</em></p>

<h2 id="our-target-and-stuffs">Our target and “Stuffs”</h2>

<p>I’ve created an Virtualbox VM using Ubuntu 18.04 and installed the
OpenSSH. After that, an user <em>admin</em> was added with a known password. We
will also use a known wordlist to conduct our brute force.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># useradd admin

# passwd admin (using the password "fuckyou")
</code></pre></div></div>

<p>Testing our target using user and password above:</p>

<p><img src="/assets/img/ssh.png" alt="SSH" /></p>

<h2 id="metasploit">Metasploit</h2>

<p>Metasploit is a tool developed by Rapid7 (https://www.metasploit.com/)
and used to execute scans, exploits and other pentest phases.</p>

<p>You can have more information about the Framework in the free Offensive
Security course at:
(https://www.offensive-security.com/metasploit-unleashed/)</p>

<p>Let’s run Metasploit to start the brute force in our virtual machine IP
address (192.168.56.13).</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ msfdb run
</code></pre></div></div>

<p>Now let’s search for an auxiliary module that should be used to root
password guess on this ip address.</p>

<p><img src="/assets/img/metasploit01.png" alt="Metasploit" /></p>

<p>As we can see in the image above, there is a module
<em>auxiliary/scanner/ssh/ssh_login</em> that we could use to check for
username and password. Let’s chose this one and show its options
(command show options).</p>

<p><img src="/assets/img/metasploit02.png" alt="Metasploit" /></p>

<p>Now we have to change some options to configure the module.</p>

<p><img src="/assets/img/metasploit03.png" alt="Metasploit" /></p>

<p>We’ve used the rockyou wordlist to configure our brute force. Feel free
to use your wordlist or create a new one. Since we know the username
(admin), we just set the password option to use a wordlist. We’ve also
changed the threads number to 10 so the process will be faster (locally
of course). We’ve set STOP_ON_SUCCESS so it stops when the password is
found. Now, time to RUN!</p>

<p><img src="/assets/img/metasploit04.png" alt="Metasploit" /></p>

<p>Gotcha! Session 1 was opened after msf discover the password.</p>

<h2 id="thc-hydra">THC Hydra</h2>

<p><em>Number one of the biggest security holes are passwords, as every
password security study shows. This tool is a proof of concept code, to
give researchers and security consultants the possibility to show how
easy it would be to gain unauthorized access from remote to a system.
There are already several login hacker tools available, however, none
does either support more than one protocol to attack or support
parallelized connects.</em> copied from his
<a href="https://github.com/vanhauser-thc/thc-hydra">github</a></p>

<p>Accordingly author, the hydra could work well on Linux, Windows/Cygwin,
Solaris, FreeBSD/OpenBSD, QNX (Blackberry 10) and MacOS. If you are
using Kali Linux the tool is already installed.</p>

<p><img src="/assets/img/hydra01.png" alt="THC Hydra" /></p>

<p>Well, the hydra command for brute force testing on SSH service looks
like this:</p>

<p>hydra -l admin -P /usr/share/wordlists/rockyou.txt 192.168.56.13 ssh</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-l : Name of user to be tested

-P : wordlist to be used for test

192.168.56.13 : server IP address

ssh : service to be tested
</code></pre></div></div>

<p>Let’s test using hydra command</p>

<p><img src="/assets/img/hydra02.png" alt="THC Hydra" /></p>

<p>Well, it works!</p>

<h2 id="nmap">NMAP</h2>

<p><em>Nmap (“Network Mapper”) is a free and open source (license) utility for
network discovery and security auditing. Many systems and network
administrators also find it useful for tasks such as network inventory,
managing service upgrade schedules, and monitoring host or service
uptime. Nmap uses raw IP packets in novel ways to determine what hosts
are available on the network, what services (application name and
version) those hosts are offering, what operating systems (and OS
versions) they are running, what type of packet filters/firewalls are in
use, and dozens of other characteristics. It was designed to rapidly
scan large networks, but works fine against single hosts. Nmap runs on
all major computer operating systems, and official binary packages are
available for Linux, Windows, and Mac OS X. In addition to the classic
command-line Nmap executable, the Nmap suite includes an advanced GUI
and results viewer (Zenmap), a flexible data transfer, redirection, and
debugging tool (Ncat), a utility for comparing scan results (Ndiff), and
a packet generation and response analysis tool (Nping).</em></p>

<p>We can use nmap scripts to do some more advanced scans in servers for
vulnerabilities and even brute force. For this one we will use the
ssh-brute nse script to achieve our objective.</p>

<p><img src="/assets/img/nmap01.png" alt="Nmap" /></p>

<p>For this test i’ve created two files (users.txt and pass.txt), filled
with admin user and the other with a little part of rockyou.txt wordlist
to be faster since we do not have the STOP on SUCCESS option and verbose
are always visible, making some noise display of results.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap 192.168.56.13 -p 22 --script ssh-brute --script-args userdb=users.txt,passdb=pass.txt
</code></pre></div></div>

<p><img src="/assets/img/nmap02.png" alt="Nmap" /></p>

<p>You can have more details at <a href="https://nmap.org/nsedoc/scripts/ssh-brute.html">nmap’s script
URL</a></p>

<h2 id="medusa">Medusa</h2>

<p><em>Medusa is intended to be a speedy, massively parallel, modular, login
brute-forcer. The goal is to support as many services which allow remote
authentication as possible.</em></p>

<p>You can have more information at <a href="http://foofus.net/goons/jmk/medusa/medusa.html">Medusa
Website</a></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>medusa -h 192.168.56.13 -u admin -P /usr/share/wordlists/rockyou.txt -e s -M ssh

-h Target hostname or IP
-u username
-P wordlist
-e password checks (*n* No Password, *s* Passowrd=Username)
-M name of the module to execute
</code></pre></div></div>

<p><img src="/assets/img/medusa01.png" alt="Medusa" /></p>

<h2 id="ncrack">Ncrack</h2>

<p><em>Ncrack is a high-speed network authentication cracking tool. It was
built to help companies secure their networks by proactively testing all
their hosts and networking devices for poor passwords. Security
professionals also rely on Ncrack when auditing their clients. Ncrack
was designed using a modular approach, a command-line syntax similar to
Nmap and a dynamic engine that can adapt its behavior based on network
feedback. It allows for rapid, yet reliable large-scale auditing of
multiple hosts.</em></p>

<p><a href="https://nmap.org/ncrack/">Ncrack’s Website</a></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ncrack --user admin -P /root/pass.txt ssh://192.168.56.13

--user -&gt; username to test
-P -&gt; wordlist
</code></pre></div></div>

<p><img src="/assets/img/ncrack01.png" alt="Ncrack" /></p>

<p>That’s all for now folks! Thanks for reading.</p>

  </div><a class="u-url" href="/infosec/pentest/2020/01/17/ssh-bruteforce-some-tools.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">Humberto Jr (bt0)</li>
          <li><a class="u-email" href="mailto:bt0@tutanota.com">bt0@tutanota.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>Just another Infosec Blog - Resources, Tutorial</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/halencarjunior" title="halencarjunior"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/bt0s3c" title="bt0s3c"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>
    <script src="https://code.jquery.com/jquery-2.1.4.min.js"
  integrity="sha384-R4/ztc4ZlRqWjqIuvf6RX5yb/v90qNGx6fS48N0tRxiGkqveZETq72KgDVJCp2TC"
  crossorigin="anonymous"></script>
  </div>

</footer>
</body>

</html>
